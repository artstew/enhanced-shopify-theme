{% doc %}
  Renders an image with text block that can be arranged side by side or stacked.

  @example
  {% content_for 'block', type: 'image_with_text', id: 'image_text' %}
{% enddoc %}

<div
  class="image-with-text image-with-text--{{ block.settings.layout }} image-with-text--{{ block.settings.image_position }}"
  style="--text-align: {{ block.settings.text_alignment }}"
  {{ block.shopify_attributes }}
>
  <div class="image-with-text__image">
    {% if block.settings.image %}
      <img 
        src="{{ block.settings.image | image_url: width: 600 }}" 
        alt="{{ block.settings.image.alt | default: block.settings.heading }}"
        loading="lazy"
      >
    {% else %}
      <div class="image-with-text__placeholder">
        <p>Add an image</p>
      </div>
    {% endif %}
  </div>
  
  <div class="image-with-text__content">
    {% if block.settings.heading != blank %}
      <h3 class="image-with-text__heading">{{ block.settings.heading }}</h3>
    {% endif %}
    
    {% if block.settings.text != blank %}
      <div class="image-with-text__text">{{ block.settings.text }}</div>
    {% endif %}
    
    {% if block.settings.button_text != blank and block.settings.button_url != blank %}
      <a href="{{ block.settings.button_url }}" class="image-with-text__button btn btn--{{ block.settings.button_style }}">
        {{ block.settings.button_text }}
      </a>
    {% endif %}
  </div>
</div>

{% stylesheet %}
  .image-with-text {
    display: flex;
    align-items: center;
    gap: 2rem;
    margin: 2rem 0;
  }
  
  .image-with-text--stacked {
    flex-direction: column;
    text-align: var(--text-align);
  }
  
  .image-with-text--side-by-side {
    flex-direction: row;
  }
  
  .image-with-text--side-by-side.image-with-text--image-right {
    flex-direction: row-reverse;
  }
  
  .image-with-text__image,
  .image-with-text__content {
    flex: 1;
  }
  
  .image-with-text__image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
  }
  
  .image-with-text__placeholder {
    background: #f0f0f0;
    padding: 3rem;
    text-align: center;
    color: #999;
    border-radius: 8px;
  }
  
  .image-with-text__heading {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 1rem;
    color: #333;
  }
  
  .image-with-text__text {
    color: #666;
    line-height: 1.6;
    margin-bottom: 1.5rem;
  }
  
  .image-with-text__button {
    display: inline-block;
    padding: 0.75rem 1.5rem;
    text-decoration: none;
    border-radius: 4px;
    transition: all 0.3s ease;
  }
  
  .image-with-text--stacked .image-with-text__content {
    text-align: var(--text-align);
  }
  
  @media (max-width: 768px) {
    .image-with-text--side-by-side {
      flex-direction: column;
      gap: 1rem;
    }
    
    .image-with-text__heading {
      font-size: 1.5rem;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Image with Text",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Image with Text"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Text",
      "default": "<p>Add your content here. You can use this section to describe your image or provide additional information.</p>"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "select",
      "id": "button_style",
      "label": "Button Style",
      "options": [
        { "value": "primary", "label": "Primary" },
        { "value": "secondary", "label": "Secondary" }
      ],
      "default": "primary"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        { "value": "side-by-side", "label": "Side by Side" },
        { "value": "stacked", "label": "Stacked" }
      ],
      "default": "side-by-side"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image Position",
      "options": [
        { "value": "image-left", "label": "Left" },
        { "value": "image-right", "label": "Right" }
      ],
      "default": "image-left"
    },
    {
      "type": "text_alignment",
      "id": "text_alignment",
      "label": "Text Alignment",
      "default": "left"
    }
  ],
  "presets": [{ "name": "Image with Text" }]
}
{% endschema %}